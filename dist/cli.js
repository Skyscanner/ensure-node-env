#!/usr/bin/env node
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var os=require("os"),events=_interopDefault(require("events")),child_process=require("child_process"),child_process__default=_interopDefault(child_process),path=_interopDefault(require("path")),fs=require("fs"),fs__default=_interopDefault(fs),util=_interopDefault(require("util"));function createCommonjsModule(e,r){return e(r={exports:{}},r.exports),r.exports}var semver=createCommonjsModule(function(e,r){var t;r=e.exports=W,t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},r.SEMVER_SPEC_VERSION="2.0.0";var n=256,o=Number.MAX_SAFE_INTEGER||9007199254740991,s=r.re=[],i=r.src=[],a=0,c=a++;i[c]="0|[1-9]\\d*";var p=a++;i[p]="[0-9]+";var u=a++;i[u]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var l=a++;i[l]="("+i[c]+")\\.("+i[c]+")\\.("+i[c]+")";var h=a++;i[h]="("+i[p]+")\\.("+i[p]+")\\.("+i[p]+")";var m=a++;i[m]="(?:"+i[c]+"|"+i[u]+")";var f=a++;i[f]="(?:"+i[p]+"|"+i[u]+")";var v=a++;i[v]="(?:-("+i[m]+"(?:\\."+i[m]+")*))";var g=a++;i[g]="(?:-?("+i[f]+"(?:\\."+i[f]+")*))";var d=a++;i[d]="[0-9A-Za-z-]+";var _=a++;i[_]="(?:\\+("+i[d]+"(?:\\."+i[d]+")*))";var y=a++,w="v?"+i[l]+i[v]+"?"+i[_]+"?";i[y]="^"+w+"$";var b="[v=\\s]*"+i[h]+i[g]+"?"+i[_]+"?",E=a++;i[E]="^"+b+"$";var x=a++;i[x]="((?:<|>)?=?)";var j=a++;i[j]=i[p]+"|x|X|\\*";var $=a++;i[$]=i[c]+"|x|X|\\*";var k=a++;i[k]="[v=\\s]*("+i[$]+")(?:\\.("+i[$]+")(?:\\.("+i[$]+")(?:"+i[v]+")?"+i[_]+"?)?)?";var S=a++;i[S]="[v=\\s]*("+i[j]+")(?:\\.("+i[j]+")(?:\\.("+i[j]+")(?:"+i[g]+")?"+i[_]+"?)?)?";var O=a++;i[O]="^"+i[x]+"\\s*"+i[k]+"$";var A=a++;i[A]="^"+i[x]+"\\s*"+i[S]+"$";var C=a++;i[C]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var P=a++;i[P]="(?:~>?)";var I=a++;i[I]="(\\s*)"+i[P]+"\\s+",s[I]=new RegExp(i[I],"g");var L=a++;i[L]="^"+i[P]+i[k]+"$";var R=a++;i[R]="^"+i[P]+i[S]+"$";var q=a++;i[q]="(?:\\^)";var T=a++;i[T]="(\\s*)"+i[q]+"\\s+",s[T]=new RegExp(i[T],"g");var V=a++;i[V]="^"+i[q]+i[k]+"$";var N=a++;i[N]="^"+i[q]+i[S]+"$";var H=a++;i[H]="^"+i[x]+"\\s*("+b+")$|^$";var M=a++;i[M]="^"+i[x]+"\\s*("+w+")$|^$";var D=a++;i[D]="(\\s*)"+i[x]+"\\s*("+b+"|"+i[k]+")",s[D]=new RegExp(i[D],"g");var U=a++;i[U]="^\\s*("+i[k]+")\\s+-\\s+("+i[k]+")\\s*$";var F=a++;i[F]="^\\s*("+i[S]+")\\s+-\\s+("+i[S]+")\\s*$";var G=a++;i[G]="(<|>)?=?\\s*\\*";for(var B=0;B<35;B++)t(B,i[B]),s[B]||(s[B]=new RegExp(i[B]));function z(e,r){if(r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof W)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(r.loose?s[E]:s[y]).test(e))return null;try{return new W(e,r)}catch(e){return null}}function W(e,r){if(r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof W){if(e.loose===r.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof W))return new W(e,r);t("SemVer",e,r),this.options=r,this.loose=!!r.loose;var i=e.trim().match(r.loose?s[E]:s[y]);if(!i)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(function(e){if(/^[0-9]+$/.test(e)){var r=+e;if(r>=0&&r<o)return r}return e}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}r.parse=z,r.valid=function(e,r){var t=z(e,r);return t?t.version:null},r.clean=function(e,r){var t=z(e.trim().replace(/^[=v]+/,""),r);return t?t.version:null},r.SemVer=W,W.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},W.prototype.toString=function(){return this.version},W.prototype.compare=function(e){return t("SemVer.compare",this.version,this.options,e),e instanceof W||(e=new W(e,this.options)),this.compareMain(e)||this.comparePre(e)},W.prototype.compareMain=function(e){return e instanceof W||(e=new W(e,this.options)),Z(this.major,e.major)||Z(this.minor,e.minor)||Z(this.patch,e.patch)},W.prototype.comparePre=function(e){if(e instanceof W||(e=new W(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var r=0;do{var n=this.prerelease[r],o=e.prerelease[r];if(t("prerelease compare",r,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return Z(n,o)}while(++r)},W.prototype.inc=function(e,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r),this.inc("pre",r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",r),this.inc("pre",r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)"number"==typeof this.prerelease[t]&&(this.prerelease[t]++,t=-2);-1===t&&this.prerelease.push(0)}r&&(this.prerelease[0]===r?isNaN(this.prerelease[1])&&(this.prerelease=[r,0]):this.prerelease=[r,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},r.inc=function(e,r,t,n){"string"==typeof t&&(n=t,t=void 0);try{return new W(e,t).inc(r,n).version}catch(e){return null}},r.diff=function(e,r){if(Y(e,r))return null;var t=z(e),n=z(r);if(t.prerelease.length||n.prerelease.length){for(var o in t)if(("major"===o||"minor"===o||"patch"===o)&&t[o]!==n[o])return"pre"+o;return"prerelease"}for(var o in t)if(("major"===o||"minor"===o||"patch"===o)&&t[o]!==n[o])return o},r.compareIdentifiers=Z;var X=/^[0-9]+$/;function Z(e,r){var t=X.test(e),n=X.test(r);return t&&n&&(e=+e,r=+r),t&&!n?-1:n&&!t?1:e<r?-1:e>r?1:0}function J(e,r,t){return new W(e,t).compare(new W(r,t))}function K(e,r,t){return J(e,r,t)>0}function Q(e,r,t){return J(e,r,t)<0}function Y(e,r,t){return 0===J(e,r,t)}function ee(e,r,t){return 0!==J(e,r,t)}function re(e,r,t){return J(e,r,t)>=0}function te(e,r,t){return J(e,r,t)<=0}function ne(e,r,t,n){var o;switch(r){case"===":"object"==typeof e&&(e=e.version),"object"==typeof t&&(t=t.version),o=e===t;break;case"!==":"object"==typeof e&&(e=e.version),"object"==typeof t&&(t=t.version),o=e!==t;break;case"":case"=":case"==":o=Y(e,t,n);break;case"!=":o=ee(e,t,n);break;case">":o=K(e,t,n);break;case">=":o=re(e,t,n);break;case"<":o=Q(e,t,n);break;case"<=":o=te(e,t,n);break;default:throw new TypeError("Invalid operator: "+r)}return o}function oe(e,r){if(r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof oe){if(e.loose===!!r.loose)return e;e=e.value}if(!(this instanceof oe))return new oe(e,r);t("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===se?this.value="":this.value=this.operator+this.semver.version,t("comp",this)}r.rcompareIdentifiers=function(e,r){return Z(r,e)},r.major=function(e,r){return new W(e,r).major},r.minor=function(e,r){return new W(e,r).minor},r.patch=function(e,r){return new W(e,r).patch},r.compare=J,r.compareLoose=function(e,r){return J(e,r,!0)},r.rcompare=function(e,r,t){return J(r,e,t)},r.sort=function(e,t){return e.sort(function(e,n){return r.compare(e,n,t)})},r.rsort=function(e,t){return e.sort(function(e,n){return r.rcompare(e,n,t)})},r.gt=K,r.lt=Q,r.eq=Y,r.neq=ee,r.gte=re,r.lte=te,r.cmp=ne,r.Comparator=oe;var se={};function ie(e,r){if(r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof ie)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new ie(e.raw,r);if(e instanceof oe)return new ie(e.value,r);if(!(this instanceof ie))return new ie(e,r);if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function ce(e,r,t,n,o,s,i,a,c,p,u,l,h){return((r=ae(t)?"":ae(n)?">="+t+".0.0":ae(o)?">="+t+"."+n+".0":">="+r)+" "+(a=ae(c)?"":ae(p)?"<"+(+c+1)+".0.0":ae(u)?"<"+c+"."+(+p+1)+".0":l?"<="+c+"."+p+"."+u+"-"+l:"<="+a)).trim()}function pe(e,r,n){for(var o=0;o<e.length;o++)if(!e[o].test(r))return!1;if(n||(n={}),r.prerelease.length&&!n.includePrerelease){for(o=0;o<e.length;o++)if(t(e[o].semver),e[o].semver!==se&&e[o].semver.prerelease.length>0){var s=e[o].semver;if(s.major===r.major&&s.minor===r.minor&&s.patch===r.patch)return!0}return!1}return!0}function ue(e,r,t){try{r=new ie(r,t)}catch(e){return!1}return r.test(e)}function le(e,r,t,n){var o,s,i,a,c;switch(e=new W(e,n),r=new ie(r,n),t){case">":o=K,s=te,i=Q,a=">",c=">=";break;case"<":o=Q,s=re,i=K,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ue(e,r,n))return!1;for(var p=0;p<r.set.length;++p){var u=r.set[p],l=null,h=null;if(u.forEach(function(e){e.semver===se&&(e=new oe(">=0.0.0")),l=l||e,h=h||e,o(e.semver,l.semver,n)?l=e:i(e.semver,h.semver,n)&&(h=e)}),l.operator===a||l.operator===c)return!1;if((!h.operator||h.operator===a)&&s(e,h.semver))return!1;if(h.operator===c&&i(e,h.semver))return!1}return!0}oe.prototype.parse=function(e){var r=this.options.loose?s[H]:s[M],t=e.match(r);if(!t)throw new TypeError("Invalid comparator: "+e);this.operator=t[1],"="===this.operator&&(this.operator=""),t[2]?this.semver=new W(t[2],this.options.loose):this.semver=se},oe.prototype.toString=function(){return this.value},oe.prototype.test=function(e){return t("Comparator.test",e,this.options.loose),this.semver===se||("string"==typeof e&&(e=new W(e,this.options)),ne(e,this.operator,this.semver,this.options))},oe.prototype.intersects=function(e,r){if(!(e instanceof oe))throw new TypeError("a Comparator is required");var t;if(r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1}),""===this.operator)return t=new ie(e.value,r),ue(this.value,t,r);if(""===e.operator)return t=new ie(this.value,r),ue(e.semver,t,r);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),o=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),s=this.semver.version===e.semver.version,i=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=ne(this.semver,"<",e.semver,r)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=ne(this.semver,">",e.semver,r)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||o||s&&i||a||c},r.Range=ie,ie.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},ie.prototype.toString=function(){return this.range},ie.prototype.parseRange=function(e){var r=this.options.loose;e=e.trim();var n=r?s[F]:s[U];e=e.replace(n,ce),t("hyphen replace",e),e=e.replace(s[D],"$1$2$3"),t("comparator trim",e,s[D]),e=(e=(e=e.replace(s[I],"$1~")).replace(s[T],"$1^")).split(/\s+/).join(" ");var o=r?s[H]:s[M],i=e.split(" ").map(function(e){return function(e,r){return t("comp",e,r),e=function(e,r){return e.trim().split(/\s+/).map(function(e){return function(e,r){t("caret",e,r),r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1});var n=r.loose?s[N]:s[V];return e.replace(n,function(r,n,o,s,i){var a;return t("caret",e,r,n,o,s,i),ae(n)?a="":ae(o)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(s)?a="0"===n?">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":">="+n+"."+o+".0 <"+(+n+1)+".0.0":i?(t("replaceCaret pr",i),"-"!==i.charAt(0)&&(i="-"+i),a="0"===n?"0"===o?">="+n+"."+o+"."+s+i+" <"+n+"."+o+"."+(+s+1):">="+n+"."+o+"."+s+i+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+s+i+" <"+(+n+1)+".0.0"):(t("no pr"),a="0"===n?"0"===o?">="+n+"."+o+"."+s+" <"+n+"."+o+"."+(+s+1):">="+n+"."+o+"."+s+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+s+" <"+(+n+1)+".0.0"),t("caret return",a),a})}(e,r)}).join(" ")}(e,r),t("caret",e),e=function(e,r){return e.trim().split(/\s+/).map(function(e){return function(e,r){r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1});var n=r.loose?s[R]:s[L];return e.replace(n,function(r,n,o,s,i){var a;return t("tilde",e,r,n,o,s,i),ae(n)?a="":ae(o)?a=">="+n+".0.0 <"+(+n+1)+".0.0":ae(s)?a=">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":i?(t("replaceTilde pr",i),"-"!==i.charAt(0)&&(i="-"+i),a=">="+n+"."+o+"."+s+i+" <"+n+"."+(+o+1)+".0"):a=">="+n+"."+o+"."+s+" <"+n+"."+(+o+1)+".0",t("tilde return",a),a})}(e,r)}).join(" ")}(e,r),t("tildes",e),e=function(e,r){return t("replaceXRanges",e,r),e.split(/\s+/).map(function(e){return function(e,r){e=e.trim(),r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1});var n=r.loose?s[A]:s[O];return e.replace(n,function(r,n,o,s,i,a){t("xRange",e,r,n,o,s,i,a);var c=ae(o),p=c||ae(s),u=p||ae(i),l=u;return"="===n&&l&&(n=""),c?r=">"===n||"<"===n?"<0.0.0":"*":n&&l?(p&&(s=0),u&&(i=0),">"===n?(n=">=",p?(o=+o+1,s=0,i=0):u&&(s=+s+1,i=0)):"<="===n&&(n="<",p?o=+o+1:s=+s+1),r=n+o+"."+s+"."+i):p?r=">="+o+".0.0 <"+(+o+1)+".0.0":u&&(r=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0"),t("xRange return",r),r})}(e,r)}).join(" ")}(e,r),t("xrange",e),e=function(e,r){return t("replaceStars",e,r),e.trim().replace(s[G],"")}(e,r),t("stars",e),e}(e,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(e){return!!e.match(o)})),i=i.map(function(e){return new oe(e,this.options)},this)},ie.prototype.intersects=function(e,r){if(!(e instanceof ie))throw new TypeError("a Range is required");return this.set.some(function(t){return t.every(function(t){return e.set.some(function(e){return e.every(function(e){return t.intersects(e,r)})})})})},r.toComparators=function(e,r){return new ie(e,r).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})},ie.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new W(e,this.options));for(var r=0;r<this.set.length;r++)if(pe(this.set[r],e,this.options))return!0;return!1},r.satisfies=ue,r.maxSatisfying=function(e,r,t){var n=null,o=null;try{var s=new ie(r,t)}catch(e){return null}return e.forEach(function(e){s.test(e)&&(n&&-1!==o.compare(e)||(o=new W(n=e,t)))}),n},r.minSatisfying=function(e,r,t){var n=null,o=null;try{var s=new ie(r,t)}catch(e){return null}return e.forEach(function(e){s.test(e)&&(n&&1!==o.compare(e)||(o=new W(n=e,t)))}),n},r.validRange=function(e,r){try{return new ie(e,r).range||"*"}catch(e){return null}},r.ltr=function(e,r,t){return le(e,r,"<",t)},r.gtr=function(e,r,t){return le(e,r,">",t)},r.outside=le,r.prerelease=function(e,r){var t=z(e,r);return t&&t.prerelease.length?t.prerelease:null},r.intersects=function(e,r,t){return e=new ie(e,t),r=new ie(r,t),e.intersects(r)},r.coerce=function(e){if(e instanceof W)return e;if("string"!=typeof e)return null;var r=e.match(s[C]);return null==r?null:z((r[1]||"0")+"."+(r[2]||"0")+"."+(r[3]||"0"))}}),semver_1=semver.SEMVER_SPEC_VERSION,semver_2=semver.re,semver_3=semver.src,semver_4=semver.parse,semver_5=semver.valid,semver_6=semver.clean,semver_7=semver.SemVer,semver_8=semver.inc,semver_9=semver.diff,semver_10=semver.compareIdentifiers,semver_11=semver.rcompareIdentifiers,semver_12=semver.major,semver_13=semver.minor,semver_14=semver.patch,semver_15=semver.compare,semver_16=semver.compareLoose,semver_17=semver.rcompare,semver_18=semver.sort,semver_19=semver.rsort,semver_20=semver.gt,semver_21=semver.lt,semver_22=semver.eq,semver_23=semver.neq,semver_24=semver.gte,semver_25=semver.lte,semver_26=semver.cmp,semver_27=semver.Comparator,semver_28=semver.Range,semver_29=semver.toComparators,semver_30=semver.satisfies,semver_31=semver.maxSatisfying,semver_32=semver.minSatisfying,semver_33=semver.validRange,semver_34=semver.ltr,semver_35=semver.gtr,semver_36=semver.outside,semver_37=semver.prerelease,semver_38=semver.intersects,semver_39=semver.coerce,commander=createCommonjsModule(function(e,r){var t=events.EventEmitter,n=child_process__default.spawn,o=path.dirname,s=path.basename;function i(e,r){this.flags=e,this.required=e.indexOf("<")>=0,this.optional=e.indexOf("[")>=0,this.bool=-1===e.indexOf("-no-"),(e=e.split(/[ ,|]+/)).length>1&&!/^[[<]/.test(e[1])&&(this.short=e.shift()),this.long=e.shift(),this.description=r||""}function a(e){this.commands=[],this.options=[],this._execs={},this._allowUnknownOption=!1,this._args=[],this._name=e||""}function c(e,r){var t=Math.max(0,r-e.length);return e+Array(t+1).join(" ")}function p(e,r){r=r||[];for(var t=0;t<r.length;t++)"--help"!==r[t]&&"-h"!==r[t]||(e.outputHelp(),process.exit(0))}function u(e){var r=e.name+(!0===e.variadic?"...":"");return e.required?"<"+r+">":"["+r+"]"}function l(e){try{if(fs__default.statSync(e).isFile())return!0}catch(e){return!1}}util.inherits(a,t),(r=e.exports=new a).Command=a,r.Option=i,i.prototype.name=function(){return this.long.replace("--","").replace("no-","")},i.prototype.attributeName=function(){return this.name().split("-").reduce(function(e,r){return e+r[0].toUpperCase()+r.slice(1)})},i.prototype.is=function(e){return this.short===e||this.long===e},a.prototype.command=function(e,r,t){"object"==typeof r&&null!==r&&(t=r,r=null),t=t||{};var n=e.split(/ +/),o=new a(n.shift());return r&&(o.description(r),this.executables=!0,this._execs[o._name]=!0,t.isDefault&&(this.defaultExecutable=o._name)),o._noHelp=!!t.noHelp,this.commands.push(o),o.parseExpectedArgs(n),o.parent=this,r?this:o},a.prototype.arguments=function(e){return this.parseExpectedArgs(e.split(/ +/))},a.prototype.addImplicitHelpCommand=function(){this.command("help [cmd]","display help for [cmd]")},a.prototype.parseExpectedArgs=function(e){if(e.length){var r=this;return e.forEach(function(e){var t={required:!1,name:"",variadic:!1};switch(e[0]){case"<":t.required=!0,t.name=e.slice(1,-1);break;case"[":t.name=e.slice(1,-1)}t.name.length>3&&"..."===t.name.slice(-3)&&(t.variadic=!0,t.name=t.name.slice(0,-3)),t.name&&r._args.push(t)}),this}},a.prototype.action=function(e){var r=this,t=function(t,n){t=t||[],n=n||[];var o=r.parseOptions(n);p(r,o.unknown),o.unknown.length>0&&r.unknownOption(o.unknown[0]),o.args.length&&(t=o.args.concat(t)),r._args.forEach(function(e,n){e.required&&null==t[n]?r.missingArgument(e.name):e.variadic&&(n!==r._args.length-1&&r.variadicArgNotLast(e.name),t[n]=t.splice(n))}),r._args.length?t[r._args.length]=r:t.push(r),e.apply(r,t)},n=this.parent||this,o=n===this?"*":this._name;return n.on("command:"+o,t),this._alias&&n.on("command:"+this._alias,t),this},a.prototype.option=function(e,r,t,n){var o=this,s=new i(e,r),a=s.name(),c=s.attributeName();if("function"!=typeof t)if(t instanceof RegExp){var p=t;t=function(e,r){var t=p.exec(e);return t?t[0]:r}}else n=t,t=null;return(!s.bool||s.optional||s.required)&&(s.bool||(n=!0),void 0!==n&&(o[c]=n,s.defaultValue=n)),this.options.push(s),this.on("option:"+a,function(e){null!==e&&t&&(e=t(e,void 0===o[c]?n:o[c])),"boolean"==typeof o[c]||void 0===o[c]?o[c]=null==e?!!s.bool&&(n||!0):e:null!==e&&(o[c]=e)}),this},a.prototype.allowUnknownOption=function(e){return this._allowUnknownOption=0===arguments.length||e,this},a.prototype.parse=function(e){this.executables&&this.addImplicitHelpCommand(),this.rawArgs=e,this._name=this._name||s(e[1],".js"),this.executables&&e.length<3&&!this.defaultExecutable&&e.push("--help");var r=this.parseOptions(this.normalize(e.slice(2))),t=this.args=r.args,n=this.parseArgs(this.args,r.unknown),o=n.args[0],i=null;return o&&(i=this.commands.filter(function(e){return e.alias()===o})[0]),this._execs[o]&&"function"!=typeof this._execs[o]?this.executeSubCommand(e,t,r.unknown):i?(t[0]=i._name,this.executeSubCommand(e,t,r.unknown)):this.defaultExecutable?(t.unshift(this.defaultExecutable),this.executeSubCommand(e,t,r.unknown)):n},a.prototype.executeSubCommand=function(e,r,t){(r=r.concat(t)).length||this.help(),"help"===r[0]&&1===r.length&&this.help(),"help"===r[0]&&(r[0]=r[1],r[1]="--help");var i,a=e[1],c=s(a,path.extname(a))+"-"+r[0],p=fs__default.lstatSync(a).isSymbolicLink()?fs__default.readlinkSync(a):a;p!==a&&"/"!==p.charAt(0)&&(p=path.join(o(a),p)),i=o(p);var u,h=path.join(i,c),m=!1;l(h+".js")?(c=h+".js",m=!0):l(h+".ts")?(c=h+".ts",m=!0):l(h)&&(c=h),r=r.slice(1),"win32"!==process.platform?m?(r.unshift(c),r=(process.execArgv||[]).concat(r),u=n(process.argv[0],r,{stdio:"inherit",customFds:[0,1,2]})):u=n(c,r,{stdio:"inherit",customFds:[0,1,2]}):(r.unshift(c),u=n(process.execPath,r,{stdio:"inherit"}));["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(function(e){process.on(e,function(){!1===u.killed&&null===u.exitCode&&u.kill(e)})}),u.on("close",process.exit.bind(process)),u.on("error",function(e){"ENOENT"===e.code?console.error("error: %s(1) does not exist, try --help",c):"EACCES"===e.code&&console.error("error: %s(1) not executable. try chmod or run with root",c),process.exit(1)}),this.runningCommand=u},a.prototype.normalize=function(e){for(var r,t,n,o=[],s=0,i=e.length;s<i;++s){if(r=e[s],s>0&&(t=this.optionFor(e[s-1])),"--"===r){o=o.concat(e.slice(s));break}t&&t.required?o.push(r):r.length>1&&"-"===r[0]&&"-"!==r[1]?r.slice(1).split("").forEach(function(e){o.push("-"+e)}):/^--/.test(r)&&~(n=r.indexOf("="))?o.push(r.slice(0,n),r.slice(n+1)):o.push(r)}return o},a.prototype.parseArgs=function(e,r){var t;return e.length?(t=e[0],this.listeners("command:"+t).length?this.emit("command:"+e.shift(),e,r):this.emit("command:*",e)):(p(this,r),r.length>0&&this.unknownOption(r[0]),0===this.commands.length&&0===this._args.filter(function(e){return e.required}).length&&this.emit("command:*")),this},a.prototype.optionFor=function(e){for(var r=0,t=this.options.length;r<t;++r)if(this.options[r].is(e))return this.options[r]},a.prototype.parseOptions=function(e){for(var r,t,n,o=[],s=e.length,i=[],a=0;a<s;++a)if(n=e[a],r)o.push(n);else if("--"!==n)if(t=this.optionFor(n))if(t.required){if(null==(n=e[++a]))return this.optionMissingArgument(t);this.emit("option:"+t.name(),n)}else t.optional?(null==(n=e[a+1])||"-"===n[0]&&"-"!==n?n=null:++a,this.emit("option:"+t.name(),n)):this.emit("option:"+t.name());else n.length>1&&"-"===n[0]?(i.push(n),a+1<e.length&&"-"!==e[a+1][0]&&i.push(e[++a])):o.push(n);else r=!0;return{args:o,unknown:i}},a.prototype.opts=function(){for(var e={},r=this.options.length,t=0;t<r;t++){var n=this.options[t].attributeName();e[n]=n===this._versionOptionName?this._version:this[n]}return e},a.prototype.missingArgument=function(e){console.error("error: missing required argument `%s'",e),process.exit(1)},a.prototype.optionMissingArgument=function(e,r){r?console.error("error: option `%s' argument missing, got `%s'",e.flags,r):console.error("error: option `%s' argument missing",e.flags),process.exit(1)},a.prototype.unknownOption=function(e){this._allowUnknownOption||(console.error("error: unknown option `%s'",e),process.exit(1))},a.prototype.variadicArgNotLast=function(e){console.error("error: variadic arguments must be last `%s'",e),process.exit(1)},a.prototype.version=function(e,r){if(0===arguments.length)return this._version;this._version=e;var t=new i(r=r||"-V, --version","output the version number");return this._versionOptionName=t.long.substr(2)||"version",this.options.push(t),this.on("option:"+this._versionOptionName,function(){process.stdout.write(e+"\n"),process.exit(0)}),this},a.prototype.description=function(e,r){return 0===arguments.length?this._description:(this._description=e,this._argsDescription=r,this)},a.prototype.alias=function(e){var r=this;if(0!==this.commands.length&&(r=this.commands[this.commands.length-1]),0===arguments.length)return r._alias;if(e===r._name)throw new Error("Command alias can't be the same as its name");return r._alias=e,this},a.prototype.usage=function(e){var r=this._args.map(function(e){return u(e)}),t="[options]"+(this.commands.length?" [command]":"")+(this._args.length?" "+r.join(" "):"");return 0===arguments.length?this._usage||t:(this._usage=e,this)},a.prototype.name=function(e){return 0===arguments.length?this._name:(this._name=e,this)},a.prototype.prepareCommands=function(){return this.commands.filter(function(e){return!e._noHelp}).map(function(e){var r=e._args.map(function(e){return u(e)}).join(" ");return[e._name+(e._alias?"|"+e._alias:"")+(e.options.length?" [options]":"")+(r?" "+r:""),e._description]})},a.prototype.largestCommandLength=function(){return this.prepareCommands().reduce(function(e,r){return Math.max(e,r[0].length)},0)},a.prototype.largestOptionLength=function(){var e=[].slice.call(this.options);return e.push({flags:"-h, --help"}),e.reduce(function(e,r){return Math.max(e,r.flags.length)},0)},a.prototype.largestArgLength=function(){return this._args.reduce(function(e,r){return Math.max(e,r.name.length)},0)},a.prototype.padWidth=function(){var e=this.largestOptionLength();return this._argsDescription&&this._args.length&&this.largestArgLength()>e&&(e=this.largestArgLength()),this.commands&&this.commands.length&&this.largestCommandLength()>e&&(e=this.largestCommandLength()),e},a.prototype.optionHelp=function(){var e=this.padWidth();return this.options.map(function(r){return c(r.flags,e)+"  "+r.description+(r.bool&&void 0!==r.defaultValue?" (default: "+JSON.stringify(r.defaultValue)+")":"")}).concat([c("-h, --help",e)+"  output usage information"]).join("\n")},a.prototype.commandHelp=function(){if(!this.commands.length)return"";var e=this.prepareCommands(),r=this.padWidth();return["Commands:",e.map(function(e){var t=e[1]?"  "+e[1]:"";return(t?c(e[0],r):e[0])+t}).join("\n").replace(/^/gm,"  "),""].join("\n")},a.prototype.helpInformation=function(){var e=[];if(this._description){e=[this._description,""];var r=this._argsDescription;if(r&&this._args.length){var t=this.padWidth();e.push("Arguments:"),e.push(""),this._args.forEach(function(n){e.push("  "+c(n.name,t)+"  "+r[n.name])}),e.push("")}}var n=this._name;this._alias&&(n=n+"|"+this._alias);var o=["Usage: "+n+" "+this.usage(),""],s=[],i=this.commandHelp();i&&(s=[i]);var a=["Options:",""+this.optionHelp().replace(/^/gm,"  "),""];return o.concat(e).concat(a).concat(s).join("\n")},a.prototype.outputHelp=function(e){e||(e=function(e){return e}),process.stdout.write(e(this.helpInformation())),this.emit("--help")},a.prototype.help=function(e){this.outputHelp(e),process.exit()}}),commander_1=commander.Command,commander_2=commander.Option;commander.option("-i, --ignore-local-bin","Ignore any binaries in ./node_modules/.bin").option("-v, --verbose","Prints information about all the binaries detected").parse(process.argv),commander.verbose||(console.log=(()=>{}));const getVersion=({command:e,localBinFolder:r,global:t=!0})=>{const n={PATH:process.env.PATH};return n.PATH=t?n.PATH.replace(`${r}${path.delimiter}`,""):`${r}${path.delimiter}${n.PATH}`,child_process.execSync(e,{env:n}).toString().replace("v","").trim()},checkVersion=(e,r)=>{let t=null;const n=path.join(process.cwd(),"package.json");try{t=require(n)}catch(e){console.error(`Unable to find ${n}!  😱${os.EOL}`),console.error(`Please ensure that this script is executed in the same directory.${os.EOL}`),process.exit(1)}t.engines&&t.engines[e]||(console.log(`There is no engine named "${e}" specified in package.json!  😱${os.EOL}`),process.exit(1));const o=t.engines[e];let s=null,i=null,a=null,c=null,p=null;try{const t=child_process.execSync("npm bin").toString().trim(),n=fs.existsSync(`${t}${path.sep}${e}`);s=getVersion({command:r,localBinFolder:t}),c=semver.satisfies(s,o),console.log(`Expected ${e} version:\t${o}`),console.log(`╰─ Global ${e} version:\t${s}\t${c?"✅️":"❌️"}`),n&&(i=getVersion({command:r,localBinFolder:t,global:!1}),p=semver.satisfies(i,o),console.log(`╰─ Local ${e} version:\t${i}\t${p?"✅️":"❌️"} (from ${t})`)),a=commander.ignoreLocalBin?s:i||s,console.log(`╰─ (using: ${a})${os.EOL}`)}catch(r){console.error(`Unable to get ${e} version!  😱${os.EOL}`),process.exit(1)}if(!semver.satisfies(a,o)){const r="https://github.com/Skyscanner/ensure-node-env/blob/master/README.md#guide";console.error(`Expected ${e} version to match ${o}, but got ${a}.  😱${os.EOL}`),console.error(`Please follow Skyscanner's node environment guide (see ${r}).${os.EOL}`),process.exit(1)}};console.info(`Checking node & npm versions...${os.EOL}`),checkVersion("node","node --version"),checkVersion("npm","npm -g --version"),console.info(`${os.EOL}All good.  👍${os.EOL}`);
